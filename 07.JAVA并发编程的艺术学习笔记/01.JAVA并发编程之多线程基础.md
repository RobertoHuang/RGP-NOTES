# 多线程

>  关于我:[http://huangth.com](http://huangth.com)
>
>  GitHub地址:[https://github.com/RobertoHuang](https://github.com/RobertoHuang)
>
> 参考资料
>
> - [并发编程网](http://ifeve.com/)
> - `JAVA`并发编程的艺术 - 书籍

早在这之前我就在`CSND`发表过一些博客讲述多线程的一些知识，那时候我天真的以为`JAVA`并发编程等同于多线程编程，随着知识的不断累积我觉得多线程应该只是`JAVA`并发编程中的一个范畴，所以重新捡起以前的博客谈谈我对并发编程的一些理解。本系列博客权当是笔者在学习并发编程的艺术过程中的一些笔记(好记性不如烂笔头)，既然是学习笔记那么它肯定不是权威的，在过程中如有误解烦请读者指出

## 并发和并行

在`JAVA`并发编程网中对两个词的解释是

- 并行是指两个或者多个事件在同一时刻发生
- 而并发是指两个或多个事件在同一时间间隔发生

大白话说就是并行是在多核处理器出现之后才成为可能，而单核处理器看似多任务同时执行其实是操作系统来完成多任务间对CPU的运行切换，由于切换的速度足够快而让人感觉它是在同时执行的

## 线程的创建

关于多线程的优缺点就不介绍了，坦白说真正要总结的话我也只能片面的阐述，下面直接介绍多线程的创建方式

- 继承`Thread`类

  ```java
  public class MyThread extends Thread {
      @Override
      public void run() {
          System.out.println(Thread.currentThread().getName() + ":继承Thread类方式创建线程");
      }
  
      public static void main(String[] args) {
          Thread thread = new MyThread();
          thread.start();
      }
  }
  ```

- 实现`Runable`接口

  ```java
  public class MyRunnable implements Runnable {
      @Override
      public void run() {
          System.out.println(Thread.currentThread().getName() + ":实现Runnable接口方式创建线程");
      }
  
      public static void main(String[] args) {
          Thread thread = new Thread(new MyRunnable());
          thread.start();
      }
  }
  ```

以上两种方式都可以创建线程且最终效果相同，不过大部分人更倾向于使用实现Runnable接口方式

- `JAVA`语言为单继承多实现

- 实现`Runnable`接口是更加符合面向对象思想，线程分为两部分一是线程对象二是线程任务
- 线程池可以有效的管理实现了`Runnable`接口的线程，如果线程池满了新的线程就会排队等候执行直到线程池空闲出来为止，而如果线程是通过实现`Thread`子类实现的这将会复杂一些

**注意:在创建线程时最好指定线程的名称，这样在进行线程分析时会给开发人员一些提示**

## 线程的状态

|   状态名称   |                             说明                             |
| :----------: | :----------------------------------------------------------: |
|     NEW      |         初始状态，线程被构建但是还没调用`start`方法          |
|   RUNNABLE   | 运行状态，`JAVA`线程将操作系统中的就绪和运行两种状态统称运行中 |
|   BLOCKED    |                  阻塞状态，表示线程阻塞于锁                  |
|   WAITING    | 等待状态，进入该状态表示当前线程需要等待其他线程作出一些特定动作(通知/中断) |
| TIME_WAITING | 超时等待状态，该状态不同于`WAITING`，它是可以在指定的时间自行返回 |
|  TERMINATED  |              终止状态，表示当前线程已经执行完毕              |

## 线程的中断

优雅的中断线程 // TODO

## 线程常用属性

- `priority`线程优先级

  线程优先级顾名思义就是用来描述线程执行顺序，可使用线程的`setPriority`方法来设置线程优先级(默认值为5，值越大优先级越高)。关于优先级设置`JAVA`并发编程的艺术中是这样说的

  > 针对频繁阻塞(休眠或者`I/O`操作)的线程需要设置较高的优先级，而偏重计算(需要较多CPU时间或者偏运算)的线程则设置较低的优先级，确保处理器不会被独占。线程优先级不能作为程序正确运行的依赖，因为操作系统可以完全不用理会`JAVA`线程对于优先级的设定

- `deamon`是否是后台线程

  `deamon`线程主要被用作程序中后台调度以及支持性工作，主线程执行完毕后对应的`Deamon`线程将立即终止，需要注意的是在构建`Deamon`线程时不能依靠`finally`块中的内容来确保执行关闭或清理资源的逻辑

